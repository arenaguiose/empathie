<!DOCTYPE html>
<html>
  <head>
    <title>Chat en ligne</title>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="stylesheets/style.css">
    <script src="javascripts/jquery.js"></script>
    <script type="text/javascript">
        var data = {
          characters: {
            me: {
              name: 'Noémie',
              photo: 'https://img2.closermag.fr/var/closermag/storage/images/article/lucie-lucas-clem-victime-d-un-burn-out-692829/5566602-1-fre-FR/Lucie-Lucas-Clem-victime-d-un-burn-out_exact1024x768_l.jpg'
            },
            other: {
              name: 'Ryan',
              photo: 'http://jjung.perso.univ-pau.fr/jung.jpg'
            }
          },
          dialogue: {
            other: 'C\'est déjà plus intime..',
            me: [
              {
                name: 'C\'est qui? ',
                dialogue: {
                  other: 'Ryan!',
                  me: [
                    {
                      name: 'Comment tu l\'as eu ? ',
                      dialogue: {
                        other: 'Suspens.. Détends toi! :*',
                         me: [ 
                          {
                            name: 'réponse 1', 
                            dialogue: []
                          },
                          {
                            name: 'réponse 2', 
                            dialogue: []
                          }
                        ]
                      }
                    }
                  ]
                }
              }
            ]
          }
        }
    </script>
    <script type="text/javascript">
      var dialogue = data.dialogue;
      var answer = null;
      var delay = 500;

      function otherTalks() {
        setTimeout(function() {
          if (dialogue.other === undefined) {
            end();
          } else {
            $('.chatlogs').append('<div class="chat friend"><div class="user-photo"><img src="' + data.characters.other.photo + '" class="one"></div><p class="chat-message">' + dialogue.other + '</p></div>');
            iTalk();
          }
        }, delay);
      }

      function iTalk() {
        setTimeout(function() {
          if (dialogue.me.length == 1) {
            iAutoAnswer();
          } else {
            iChoose();
          }  
        }, delay);
      }

      function iAutoAnswer() {
        answer = dialogue.me[0];
        iAnswer();
      }

      function iAnswer() {
        $('.chatlogs').append('<div class="chat self"><img src="' + data.characters.me.photo + '" class="two"><div class="user-photo"></div><p class="chat-message">' + dialogue.me[0].name + '</p></div>');
        dialogue = answer.dialogue;
        otherTalks();
      }

      function iChoose() {
        for (var i = 0; i < dialogue.me.length; i++) {
          var option = dialogue.me[i];
          $('.chatform').append('<div class="option" data-index="' + i + '">' + option.name + '</div>');
          $('.chatform div').click(function() {
            var index = $(this).data('index');
            answer = dialogue.me[index];
            $('.chatform').html('');
            iAnswer();
          })
        }
      }

      function end() {
        alert('FIN');
      }

      $(function() {
        $('.title').html(data.characters.other.name);
        otherTalks();
      });
    </script>
  </head>
  <body>
    <div class="chatbox">
      <div class="chatlogs">
        <div class="title"></div>
        <!--
        <div class="chat friend" id="M1">
            <div class="user-photo"><img src="Ryan.jpg" class="one">
            </div>
            <p class="chat-message"> C’est déjà plus intime.. </p>
        </div>
        <div class="chat self" id="M2"><img src="Noémie.jpg" class="two">
            <div class="user-photo">
            </div>
            <p class="chat-message"> C’est qui? </p>
        </div>
        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Ryan! </p>
        </div>
        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Je peux tout avoir, même ton numéro! ;) </p>
        </div>

        <div class="chat self"><img src="Noémie.jpg" class="two">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Comment tu l’as eu? </p>
        </div>
        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Suspens.. Détends toi! :* </p>
        </div>
        <div class="chat self"><img src="Noémie.jpg" class="two">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Dis moi! </p>
        </div>
        <div class="chat self"><img src="Noémie.jpg" class="two">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Je ne veux pas que tout le monde ait mon num </p>
        </div>
        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> J’ai cherché et je l’ai trouvé!</p>
        </div>
        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Il est facile à trouver!</p>
        </div>
        <div class="chat self"><img src="Noémie.jpg" class="two">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Comment ça? </p>
        </div>
        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> J'ai des contacts </p>
        </div>
        <div class="chat self"><img src="Noémie.jpg" class="two">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Qui te l'a donné? </p>
        </div>
        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Je ne te le dirai pas de toute façon </p>
        </div>
        <div class="chat self"><img src="Noémie.jpg" class="two">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Pourquoi tu fais ça? </p>
        </div>
        <div class="chat self"><img src="Noémie.jpg" class="two">
            <div class="user-photo">
            </div>
            <p class="chat-message"> T'es différent.. </p>
        </div>
        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Je n’ai rien fait! </p>
        </div>
        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> C’est quand même mieux de parler par sms! </p>
        </div>
        <div class="chat self"><img src="Noémie.jpg" class="two">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Je préfère la messagerie privée </p>
        </div>
        <div class="chat self"><img src="Noémie.jpg" class="two">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Le téléphone c’est pour les gens que je connais </p>
        </div>

        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> On commence à se connaître! </p>
        </div>
        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Et tu n’as plus de problème d’internet comme ça! </p>
        </div>
        <div class="chat self"><img src="Noémie.jpg" class="two">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Pas pour te vexer </p>
        </div>
        <div class="chat self"><img src="Noémie.jpg" class="two">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Mais j'aurais préféré te le donner plutôt que t'ailles fouiller </p>
        </div>
        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Tu ne voulais pas! </p>
        </div>
        <div class="chat self"><img src="Noémie.jpg" class="two">
            <div class="user-photo">
            </div>
            <p class="chat-message"> C’était pour une bonne raison… je préfère que ça reste virtuel </p>
        </div>
        <div class="chat self"><img src="Noémie.jpg" class="two">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Le téléphone c’est trop ‘réel’, enfin c’est pour mes amis et ma famille, quoi </p>
        </div>
        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Très bien, désolé </p>
        </div>
        <div class="chat friend"><img src=Ryan.jpg class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Je pensais pas que tu t’énerverais pour ça </p>
        </div>
        <div class="chat self"><img src="Noémie.jpg" class="two">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Tu fais souvent ça.. </p>
        </div>
        <div class="chat self"><img src="Noémie.jpg" class="two">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Tu fouilles beaucoup je trouve </p>
        </div>
        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Je veux juste apprendre à te connaître </p>
        </div>
        <div class="chat self"><img src="Noémie.jpg" class="two">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Mais pas comme ça ! Même moi je te connais à peine, tu parles rarement de toi </p>
        </div>
        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Pose moi des questions! </p>
        </div>
        <div class="chat self"><img src="Noémie.jpg" class="two">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Ben là comme ça je sais pas trop… </p>
        </div>
        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Tu vois, c’est toi qui est distante! </p>
        </div>
        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Moi je m’intéresse à toi au moins </p>
        </div>
        <div class="chat self"><img src="Noémie.jpg" class="two">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Mais je m’intéresse, c’est juste que tu me prends de court ! </p>
        </div>
        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Tu es susceptible! </p>
        </div>
        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Une question c’est pas compliquée à trouver! </p>
        </div>
        <div class="chat self"><img src="Noémie.jpg" class="two">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Bon ça va, il est tard et j’ai pas la tête à ça c’est tout </p>
        </div>
        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> J'attendrais ton message demain </p>
        </div>
        <div class="chat friend"><img src="Ryan.jpg" class="one">
            <div class="user-photo">
            </div>
            <p class="chat-message"> Bonne nuit :* </p>
        </div>
        -->
      </div>
      <div class="chatform">
      </div>
    </div>
  </body>
</html>
